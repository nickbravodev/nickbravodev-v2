---
// Form handling
import { isInputError } from "astro:actions";
import { actions } from "astro:actions";

const result = Astro.getActionResult(actions.send);
if (result?.data) {
  return Astro.redirect("/success");
}

const inputErrors = isInputError(result?.error) ? result.error.fields : {};

// Library imports
import { Icon } from 'astro-icon/components';
import { getCollection } from "astro:content";

// Layout imports
import MainLayout from "../layouts/MainLayout.astro";
import Button from '../components/Button.astro';
import ContactForm from '../components/forms/ContactForm.astro';
import WorkListFeatured from "../components/WorkListFeatured.astro";
const works = await getCollection("works");

// Image imports
import { Image } from 'astro:assets';
import profileImageGoofy from "../img/nb-goofy.jpg";
import profileImage from "../img/nb-new.jpg";
---

<MainLayout
  title="Designer. Developer. Problem solver."
>

  <!-- Hero section -->
    <section id="home" class="section__100vh">
      <div class="container">
        <!-- Hero text -->
        <div class="grid-2">
          <div>
            <p class="superheading">Nick Bravo.</p>
            <h1>Designer. Developer. Problem solver.</h1>
            <div class="hr-div"></div>
            <p class="subheading">
              I build engaging, high-performing websites, graphics, and digital assets to solidify brand authority and trust across platforms.
            </p>
            <!-- CTA buttons -->
            <div class="flex gap">
              <Button href="contact" />
              <Button href="resume" data-bs-toggle="offcanvas" data-bs-target="#resume" aria-controls="resume" />
            </div>
          </div>
          <!-- Hero image SVG -->
          <div class="hero-image">
            <Image src={profileImageGoofy} class="profile-image" alt="This is me. Nick Bravo." format="avif" loading="eager" />
            <!-- <Icon name="nickbravodev" /> -->
          </div>
        </div>
      </div>
    </section>

    <!-- About section -->
    <section id="about" class="section__100vh">
      <div class="container flex-md-row-reverse">
          <!-- About text -->
          <div class="section__body flex flex-column">
            <h2>Career change from cop to web developer? Don't mind if I do!</h2>
            <div class="hr-div"></div>
            <p>Short version? I recently made a career change from a full-time cop / part-time web developer/designer back to a full-time web developer.</p>
            <p>I worked full-time as a graphic and web designer for two years before working in law enforcement. I worked on a lot of freelance web development projects during my 15-year law enforcement career.</p>
            <p class="mb-4">
              Long version? My official biography is set to be released in 2552.
            </p> <!-- IYKYK -->
            <!-- CTA buttons -->
            <div class="flex gap">
              <Button href="contact" />
              <Button href="resume" data-bs-toggle="offcanvas" data-bs-target="#resume" aria-controls="resume" />
            </div>
          </div>
          <!-- Profile photo. Yes, it's really a photo of me! -->
          <div class="section__aside hero-image d-none flex-md">
            <!-- <Image src={profileImage} class="profile-image" alt="This is me. Nick Bravo." format="avif" /> -->
            <Icon name="nickbravodev" />
          </div>
      </div>
    </section>

    <!-- Scope section -->
    <section id="scope" class="section__100vh">
      <div class="container">
        <div class="section__body">
          <!-- Scope main text -->
          <h2>Languages & frameworks.</h2>
          <div class="hr-div"></div>
          <p class="subheading">
            I've been developing websites using HTML, CSS, and JavaScript and designing graphics, layouts, and brand assets with Adobe software since 2004 - you know, back when we could break MySpace. I have a solid mastery of HTML, CSS, JS and Adobe Illustrator, InDesign, and Photoshop.
          </p>
          <p>
            <code>Adobe CC, VS Code, Astro, Next.js, Bootstrap, Webflow, WordPress</code>
          </p>
          <div class="flex gap">
            <Button href="contact" />
            <Button href="resume" data-bs-toggle="offcanvas" data-bs-target="#resume" aria-controls="resume" />
          </div>
        </div>
          <!-- Scope detail text -->
          <div class="section__aside">
            <h3 class="mb-1">Design</h3>
            <p>Figma, Adobe Illustrator, InDesign, Photoshop, XD.</p>
            <h3 class="mb-1">Frontend</h3>
            <p>HTML, CSS, JavaScript, TypeScript.</p>
            <h3 class="mb-1">Backend</h3>
            <p>Netlify, Node.js, NGINX, Contentful, GraphQL, Rest.</p>
            <h3 class="mb-1">Libraries & Builders</h3>
            <p>Astro, Next.js, Bootstrap, Webflow, WordPress.</p>
          </div>
        <!-- </div> -->
      </div>
    </section>

    <!-- Portfolio section -->
    <section id="work" class="section__alt">
      <div class="container flex-column">
        <!-- Portfolio header -->
        <h2 class="text-dark text-center">A few of my projects.</h2>
        <div class="hr-div"></div>
        <p class="subheading text-dark text-center pb-5">
          Here are some projects I've worked on as a designer and developer.
        </p>
        

        <WorkListFeatured works={works} />

      </div>
    </section>

    <!-- Contact section -->
    <section id="contact">
      <div class="contact-wrapper">
        <div>
          <!-- Contact text -->
          <h2>Get in touch.</h2>
          <div class="hr-div"></div>
          <p class="subheading">
            I'm ready to join your team! Send me a message if you think we'd be a great fit! 
          </p>
        </div>

        <!-- Contact form -->
        <div>
          <form action={actions.send} method="post">
            <label
              >Username<input
                type="text"
                name="username"
                placeholder="Username"
                required
                aria-describedby={inputErrors.username ? "username-error" : undefined}
              />
            </label>
            {
              inputErrors.username && (
                <p id="username-error">{inputErrors.username[0]}</p>
              )
            }
            <label
              >Email<input
                type="email"
                name="email"
                placeholder="Email"
                required
                aria-describedby={inputErrors.email ? "email-error" : undefined}
              />
            </label>
            {inputErrors.email && <p id="email-error">{inputErrors.email[0]}</p>}
            <button>Send</button>
          </form>
    
          <!-- <form name="contact-form" id="contact-form" action={actions.send} method="POST">
            <input type="hidden" name="access_key" value="a11bce5f-44db-4845-b3d7-74506ba572a8">
            <input type="hidden" name="redirect" value="https://nickbravo.dev/success"> -->

            <!-- Name input -->

            <!-- <div>
              <label class="form-label sr-only" for="name">Name</label>
              <input class="form-control" type="text" id="name" name="name" placeholder="Name" required />
            </div> -->

            <!-- Email input -->
             
            <!-- <div>
              <label class="form-label sr-only" for="email">Email</label>
              <input class="form-control" type="email" id="email" name="email" placeholder="Email" required />
            </div> -->

            <!-- Message input -->

            <!-- <div>
              <label class="form-label sr-only" for="description">Message</label>
              <textarea class="form-control" rows="3" id="description" name="message" placeholder="Type your message here" required></textarea>
            </div> -->

            <!-- Submit button -->

            <!-- <div class="h-captcha"
              data-captcha="true"
              data-theme="dark">
            </div>
            <div>
              <button class="outline" type="submit">Send message</button>
            </div>
          </form> -->
        </div>
        
      </div>
    </section>

    <!-- <script src="https://web3forms.com/client/script.js" async defer></script> -->

    <!-- <script is:inline>
      const form = document.getElementById('contact-form');

      form.addEventListener('submit', function(e) {

          const hCaptcha = form.querySelector('textarea[name=h-captcha-response]').value;

          if (!hCaptcha) {
              e.preventDefault();
              alert("Please fill out captcha field")
              return
          }
      });
    </script> -->

    <style lang="scss">
      .contact-wrapper {
        display: grid;
        grid-template-columns: 1fr;
        align-items: flex-start;
        justify-content: flex-start;
        gap: 3rem;
        margin-block-start: 8rem;
        
        @media screen and (min-width: 768px) {
          grid-template-columns: 1fr 1fr;
        }
        
        @media screen and (min-width: 992px) {
          grid-template-columns: 1fr 1fr;
          gap: 4rem;
        }
      }
    </style>

</MainLayout>
